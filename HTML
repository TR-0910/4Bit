<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Decentralized Identity Vault</title>
  <style>
    body {margin: 0; font-family: 'Poppins', sans-serif; background-color: #f2f5f2;}
    header {
      background-color: #8da68c; 
      color: white; 
      padding: 15px 20px; 
      text-align: center; 
      font-size: 1.5em; 
      font-weight: bold;
    }
    .container {padding: 30px; display: grid; grid-template-columns: 1fr 2fr; gap: 25px;}
    .card {
      background: white; 
      border-radius: 10px; 
      box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
      padding: 20px;
      border-left: 6px solid #9cb89a;
    }
    h2 {color: #6b8f6a;}
    button {
      background-color: #7fa27e; 
      color: white; 
      border: none; 
      padding: 10px 16px; 
      border-radius: 6px; 
      cursor: pointer;
      transition: 0.2s ease-in-out;
    }
    button:hover {background-color: #6b8f6a;}
    table {width: 100%; border-collapse: collapse; margin-top: 10px;}
    th, td {border: 1px solid #ddd; padding: 8px; text-align: left;}
    th {background-color: #e7ede6;}
    footer {
      text-align: center; 
      background-color: #8da68c; 
      color: white; 
      padding: 10px; 
      margin-top: 20px;
    }
    input {
      padding: 8px; 
      width: 100%; 
      margin-top: 8px; 
      border: 1px solid #ccc; 
      border-radius: 5px;
    }
    .form-group {margin-top: 10px;}
    img {
      border-radius: 10px; 
      width: 120px; 
      height: 120px; 
      object-fit: cover; 
      margin-top: 10px;
      border: 2px solid #9cb89a;
    }
  </style>
</head>
<body>

  <header>Decentralized Digital Identity Vault</header>

  <div class="container">
    <!-- Identity Section -->
    <div class="card">
      <h2>My Identity</h2>
      <div class="form-group">
        <label><strong>DID:</strong></label>
        <p id="did-display">did:user:9f3b2c1dA4...</p>
        <button onclick="generateDID()">Generate New DID</button>
      </div>

      <div class="form-group">
        <label>Contact Number:</label>
        <input type="text" id="contact" placeholder="Enter your contact number">
      </div>

      <div class="form-group">
        <label>Aadhaar Number:</label>
        <input type="text" id="aadhar" placeholder="Enter Aadhaar Number (XXXX-XXXX-XXXX)">
      </div>

      <div class="form-group">
        <label>Upload Photo:</label>
        <input type="file" id="photo" accept="image/*" onchange="previewPhoto(event)">
        <img id="photo-preview" src="" alt="Your Photo" style="display:none;">
      </div>

      <button style="margin-top:10px;" onclick="saveIdentity()">Save Identity</button>
    </div>

    <!-- Credentials Section -->
    <div class="card">
      <h2>My Credentials</h2>
      <table id="credential-table">
        <thead>
          <tr>
            <th>Credential</th>
            <th>Issuer</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="table-body">
          <tr>
            <td>Aadhaar ID</td>
            <td>GOVT.</td>
            <td style="color:green;">Verified</td>
            <td><button onclick="shareCredential('Aadhaar ID')">Share</button></td>
          </tr>
          <tr>
            <td>PAN</td>
            <td>GOVT.</td>
            <td style="color:orange;">Pending</td>
            <td><button onclick="verifyCredential('PAN')">Verify</button></td>
          </tr>
        </tbody>
      </table>

      <!-- Add new credential form -->
      <div style="margin-top: 20px;">
        <h3>Add New Credential</h3>
        <div class="form-group">
          <label>Credential Name:</label>
          <input type="text" id="cred-name" placeholder="e.g. Driving License">
        </div>
        <div class="form-group">
          <label>Issuer:</label>
          <input type="text" id="cred-issuer" placeholder="e.g. Transport Dept.">
        </div>
        <button style="margin-top:10px;" onclick="addCredential()">Add Credential</button>
      </div>
    </div>
  </div>

  <footer>Â© 2025 Secure, Private & Self-Sovereign Identity Platform</footer>

  <script>
    function generateDID() {
      const randomHex = Math.random().toString(16).substring(2, 10);
      const newDID = `did:user:${randomHex}`;
      document.getElementById('did-display').innerText = newDID;
      localStorage.setItem("userDID", newDID);
      alert("âœ… New DID generated successfully!");
    }

    function saveIdentity() {
      const contact = document.getElementById('contact').value.trim();
      const aadhar = document.getElementById('aadhar').value.trim();
      const did = document.getElementById('did-display').innerText;
      const photoSrc = document.getElementById('photo-preview').src;

      if (!contact || !aadhar) {
        alert("Please fill all fields!");
        return;
      }

      const userData = { did, contact, aadhar, photoSrc };
      localStorage.setItem("userIdentity", JSON.stringify(userData));
      alert("ðŸ’¾ Identity saved successfully!");
    }

    function previewPhoto(event) {
      const reader = new FileReader();
      reader.onload = function() {
        const img = document.getElementById('photo-preview');
        img.src = reader.result;
        img.style.display = 'block';
      }
      reader.readAsDataURL(event.target.files[0]);
    }

    function addCredential() {
      const name = document.getElementById('cred-name').value.trim();
      const issuer = document.getElementById('cred-issuer').value.trim();

      if (!name || !issuer) {
        alert("Please fill all fields");
        return;
      }

      const status = "Pending"; // default status
      const table = document.getElementById('table-body');
      const newRow = document.createElement('tr');
      newRow.innerHTML = `
        <td>${name}</td>
        <td>${issuer}</td>
        <td style="color:orange;">${status}</td>
        <td><button onclick="shareCredential('${name}')">Share</button></td>
      `;
      table.appendChild(newRow);

      const stored = JSON.parse(localStorage.getItem("credentials")) || [];
      stored.push({ name, issuer, status });
      localStorage.setItem("credentials", JSON.stringify(stored));

      document.getElementById('cred-name').value = "";
      document.getElementById('cred-issuer').value = "";
      alert("âœ… Credential added successfully!");
    }

    function shareCredential(name) {
      alert(`ðŸ”— Credential "${name}" shared securely using DID connection.`);
    }

    function verifyCredential(name) {
      alert(`âœ… Credential "${name}" verified successfully on blockchain.`);
    }

    window.onload = function() {
      const savedDID = localStorage.getItem("userDID");
      if (savedDID) document.getElementById('did-display').innerText = savedDID;

      const storedCreds = JSON.parse(localStorage.getItem("credentials")) || [];
      const table = document.getElementById('table-body');
      storedCreds.forEach(c => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${c.name}</td>
          <td>${c.issuer}</td>
          <td style="color:${c.status === 'Verified' ? 'green' : 'orange'};">${c.status}</td>
          <td><button onclick="shareCredential('${c.name}')">Share</button></td>
        `;
        table.appendChild(row);
      });

      const savedIdentity = JSON.parse(localStorage.getItem("userIdentity"));
      if (savedIdentity) {
        document.getElementById('contact').value = savedIdentity.contact;
        document.getElementById('aadhar').value = savedIdentity.aadhar;
        if (savedIdentity.photoSrc) {
          document.getElementById('photo-preview').src = savedIdentity.photoSrc;
          document.getElementById('photo-preview').style.display = 'block';
        }
      }
    };
  </script>

</body>
</html>
